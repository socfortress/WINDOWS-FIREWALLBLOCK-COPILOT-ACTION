{
  "copilot_action_name": "WINDOWS-FIREWALLBLOCK-COPILOT-ACTION",
  "description": "Creates a Windows Defender Firewall rule to block a specific IPv4 address (Inbound or Outbound). Validates IPv4 format, is idempotent (reports if rule already exists), and emits a single NDJSON line with the outcome. Writes atomically to the Active Response log with .new fallback. Requires administrative privileges.",
  "technology": "Windows",
  "icon": "windows",
  "script_parameters": [
    {
      "name": "TargetIP",
      "type": "string",
      "required": true,
      "description": "IPv4 address to block (e.g., 203.0.113.10)."
    },
    {
      "name": "Direction",
      "type": "string",
      "required": false,
      "description": "Firewall rule direction: Inbound or Outbound.",
      "default": "Inbound"
    },
    {
      "name": "MaxWaitSeconds",
      "type": "integer",
      "required": false,
      "description": "Optional max wait/timeout budget for operations.",
      "default": 300
    },
    {
      "name": "LogPath",
      "type": "string",
      "required": false,
      "description": "Path to the rotating human-readable script log.",
      "default": "%TEMP%/BlockIP-script.log"
    },
    {
      "name": "ARLog",
      "type": "string",
      "required": false,
      "description": "Active Response NDJSON output path (atomic overwrite; falls back to .new if locked).",
      "default": "C:\\Program Files (x86)\\ossec-agent\\active-response\\active-responses.log"
    }
  ],
  "repo_url": "https://github.com/socfortress/WINDOWS-FIREWALLBLOCK-ACTIVERESPONSE",
  "script_name": "windows-firewall-ip-block.ps1",
  "version": "1.0.0",
  "last_updated": "2025-08-22T00:00:00Z"
}
